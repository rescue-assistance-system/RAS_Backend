<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="Content-Security-Policy"
            content="
        default-src 'self' http://localhost:8081 ws://localhost:8081;
        style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/ https://unpkg.com/;
        script-src 'self' 'unsafe-inline' https://cdn.socket.io/ https://unpkg.com/ https://cdn.jsdelivr.net/;
        img-src 'self' https://*.tile.openstreetmap.org data:;
        connect-src 'self' http://localhost:8081 ws://localhost:8081 https://*.tile.openstreetmap.org;
        font-src 'self' https://cdn.jsdelivr.net/;
    "
        />
        <title>Socket.IO Test Client</title>

        <!-- External CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />

        <!-- External JS -->
        <script src="https://cdn.socket.io/4.5.4/socket.io.min.js" defer></script>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" defer></script>

        <style>
            body {
                padding: 20px;
                background-color: #f8f9fa;
            }

            .container {
                max-width: 1200px;
            }

            .card {
                margin-bottom: 20px;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            #map {
                height: 400px;
                width: 100%;
                border-radius: 4px;
            }

            .status-dot {
                display: inline-block;
                width: 10px;
                height: 10px;
                border-radius: 50%;
                margin-right: 8px;
            }

            .status-connected {
                background-color: #28a745;
            }

            .status-disconnected {
                background-color: #dc3545;
            }

            #eventLog {
                font-family: monospace;
                font-size: 12px;
                white-space: pre-wrap;
                margin: 0;
            }

            .btn {
                margin-right: 10px;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1 class="mb-4">Socket.IO Test Client</h1>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Connection Status</h5>
                    <div>
                        <span class="status-dot status-disconnected" id="statusDot"></span>
                        <span id="connectionStatus">Disconnected</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">User Controls</h5>
                    <div class="mb-3">
                        <label for="userId" class="form-label">User ID:</label>
                        <input type="text" class="form-control" id="userId" placeholder="Enter user ID" />
                    </div>
                    <button class="btn btn-primary" id="connectBtn">Connect</button>
                    <button class="btn btn-danger" id="disconnectBtn">Disconnect</button>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Location Controls</h5>
                    <div class="mb-3">
                        <label for="targetId" class="form-label">Target ID (for rescue team):</label>
                        <input type="text" class="form-control" id="targetId" placeholder="Enter target user ID" />
                    </div>
                    <button class="btn btn-success" id="requestLocationBtn">Request Location</button>
                    <button class="btn btn-info" id="shareLocationBtn">Share My Location</button>
                    <button class="btn btn-warning" id="stopSharingBtn">Stop Sharing</button>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Location Map</h5>
                    <div id="map"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Event Logs</h5>
                    <div class="bg-light p-3" style="max-height: 200px; overflow-y: auto">
                        <pre id="eventLog"></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Move script to external file -->
        <script src="./socket-test.js" defer></script>
    </body>
</html>
